# 数据分析

## 从入门到进阶

> 读书笔记，机械工业出版社， 陈洪波、刘顺祥等编著

### 第一章 数据分析入门

### 第二章 从玩转Excel开始

> Mac Excel 2019 没有 Power Pivot

#### 重要概念：

**平均值：一组数据之和除以数据的个数。**

**标准误差：标准差除以样本容量的开平方来计算的。**

**中位数：排序后位于中间的数据的值。**

**众数：出现次数最多的值。**

**标准差：各个数据分别与其平均数之差的平方的和的平均数的平方根。标准差是反映一组数据离散程度最常用的一种量化形式，是表示精确度的重要指标。**

**方差：各个数据分别与其平均数之差的平方的和的平均数。**

**峰值：衡量数据分布起伏变化的指标，以正态分布为基准，比其平缓时值为正，反 之则为负；**

**偏度：衡量数据峰值偏移的指数，根据峰值在均值左侧或者右侧分别为正值或负值；**

**区域：最大值与最小值的差值。**

**最小值：一组数据中的值最小的数据。**

**最大值：一组数据中的值最大的数据。**

**求和：一组数据中所有数据的和。**

**观测数：一组数据中所有数据的个数。**

**第k大**(小)**值：输出表的某一行中包含每个数据区域中的第k个最大**(小)值。

置信度：总体均值区间估计的置信度。95%指的是总体均值有95%的可能性在计算出的区间中。

#### 回归统计表中的指标解释

* **Multiple R**：衡量回归模型预测值与实际值之间的整体相关程度，数值越接近 1 表明模型拟合越好。
* **R Square（R²）**：表示自变量对因变量变异的解释比例，用于反映模型的总体解释能力。
* **Adjusted R Square**：在 R² 基础上对自变量数量和样本规模进行修正，用于更客观地评价模型拟合优度。
* **标准误差（Standard Error）**：反映回归模型预测值与实际值之间平均偏离程度，用于衡量预测精度。
* **观测值（Observations）**：参与回归分析的有效样本数量，是模型统计推断可靠性的基础。

#### 回归系数表中的指标解释

* **Coefficients（回归系数）**：表示在其他条件不变时，自变量每变化一个单位对因变量产生的平均影响。
* **标准误差（系数标准误）**：衡量回归系数估计值的波动程度，用于反映估计的不确定性。
* **t Stat（t 统计量）**：通过比较回归系数与其标准误差，检验该系数是否显著不为零。
* **P-value（显著性水平）**：表示在零假设成立的前提下，观察到当前或更极端结果的概率，用于判断系数显著性。
* **Lower 95%**：回归系数在 95% 置信水平下的下限估计值。
* **Upper 95%**：回归系数在 95% 置信水平下的上限估计值。

### 第三章 海量数据管理——拿MySQL说事儿


> **IN 适合小结果集的集合过滤，EXISTS 适合大表的存在性判断；在关联查询中，EXISTS 通常比 IN 更稳定，而 JOIN 是实际工程中最推荐的写法。**
>
> **DISTINCT** 用于 **去除查询结果中的重复行**，只保留唯一记录。这是其唯一、明确的语义。
>
>
> ## **内连接（INNER JOIN）——只要“双方都满足”**
>
> **定义（精确版）**
>
>> 只有当 **左表行** 和 **右表行** 同时满足 **ON** 条件时，该行才会出现在结果集中。
>>
>
>
>
> ## **左连接（LEFT JOIN）——先保左表，再谈匹配**
>
> **定义（精确版）**
>
>> 左表的 **每一行都必须保留** **；**
>>
>
>> 右表仅在 **ON** 条件满足时才填值，否则右表列为 **NULL**。
>>



#### 索引的注意事项”**系统地梳理一遍，按**设计原则 → 使用误区 → 实战建议**三个层次来讲，偏工程实践，不讲空话。

---

##### **一、索引的本质认知（先统一思想）**

 **索引不是为了“快查询”，而是为了“少扫描”** **。**

* 没索引：全表扫描（Table Scan）
* 有索引：定位 → 少量行回表（Index Seek + Lookup）

👉 所有注意事项，本质都围绕一句话：

**能否让优化器用“最小代价”缩小扫描范围**

---

##### **二、建索引时的核心注意事项（非常重要）**

###### **1️⃣ 索引并非越多越好**

* 每个索引都会带来：
  * INSERT / UPDATE / DELETE 成本
  * 存储空间占用
* **高并发写表 + 过多索引 = 性能灾难**

**原则：**

> 只为“高频查询 + 有选择性”的字段建索引

---

###### **2️⃣ 优先给 WHERE / JOIN / ORDER BY 用到的列建索引**

常见高价值字段：

* WHERE user_id = ?
* JOIN t1.id = t2.id
* ORDER BY create_time DESC

低价值字段：

* 几乎不出现在查询条件中的列
* 只用于展示、不参与筛选的列

---

###### **3️⃣ 选择性（区分度）决定索引价值**

```
性别（男/女） → 选择性极低 ❌
身份证号       → 选择性极高 ✅
```

判断方法（经验）：

```
不同值数量 / 总行数 ≥ 0.1   → 值得建
```

---

###### **4️⃣ 组合索引遵循「最左前缀原则」**

```
CREATE INDEX idx_user_time ON orders(user_id, order_time);
```

能命中的条件：

* **user_id = ?**              ✅
* user_id = ? AND order_time > ?** ✅**

不能命中的：

* order_time > ?** **          **❌**

 **顺序非常关键** **：**

**👉 ****等值条件放前，范围条件放后**

---

###### **5️⃣ 不要在索引列上“动手脚”**

**以下写法** **会让索引失效** **：**

```
WHERE YEAR(create_time) = 2024
WHERE amount + 1 > 100
WHERE name LIKE '%abc'
```

正确方式：

```
WHERE create_time BETWEEN '2024-01-01' AND '2024-12-31'
WHERE amount > 99
WHERE name LIKE 'abc%'
```

---

##### **三、使用索引时最容易踩的坑**

###### **6️⃣ 隐式类型转换 = 索引直接废掉**

```
-- phone 是 VARCHAR
WHERE phone = 13812345678    -- ❌
WHERE phone = '13812345678'  -- ✅
```

优化器一旦需要**类型转换**，索引基本就用不上了。

---

###### **7️⃣ NULL 值与索引的关系**

* 普通索引可以包含 NULL
* 但：

```
WHERE col IS NULL
```

* 在某些数据库 / 场景下**不走索引**

**建议：**

* **核心字段尽量 **NOT NULL
* 用业务默认值代替 NULL

---

###### **8️⃣ 小表不一定需要索引**

经验法则（非绝对）：

* 几百行、几千行的小表
* 全表扫描成本 < 索引回表成本

**👉 ****索引是为“大表”准备的**

---

##### **四、维护与验证层面的注意事项**

###### **9️⃣ 一定要用 EXPLAIN 验证**

```
EXPLAIN SELECT ...
```

重点看：

* type**：**ref** / **range** / **index** / **ALL
* **rows**：预估扫描行数
* **key**：是否真的用到了你建的索引

**没有 EXPLAIN 的索引优化，都是拍脑袋。**

---

###### **🔟 定期清理“僵尸索引”**

僵尸索引特征：

* 从不被查询使用
* 但每次写操作都在维护

```
SHOW INDEX FROM table_name;
```

结合慢查询日志判断是否需要删除。

---

##### **五、结合你现有 SQL 示例的点评（结合实际）**

你示例里这些是**正确示范**：

```
CREATE INDEX date_index ON stu_card(custom_date);
```

```
CREATE UNIQUE INDEX id_idx ON tourism_orders(userid, orderid);
```

👍：

* 时间范围查询
* 组合唯一索引
* 用索引前后对比查询

**这是****教学级、也是实战级**的写法。

---

##### **六、一句话总结（给你记忆用）**

> **索引不是越多越好，而是越“对查询有用”越好**

> **能不用函数、不转换类型、不乱 LIKE，就已经赢了一半**

如果你愿意，下一步我可以帮你：

* **逐条 SQL 判断索引是否合理**
* **设计一套“订单/用户/时间”通用索引模型**
* **或把这套内容整理成****高项 / 数据分析可背诵版本**



DESC table_name;

### 第四章 数据可视化——Tableau的使用

### 第五章 数据分析进阶——Python数据分析
